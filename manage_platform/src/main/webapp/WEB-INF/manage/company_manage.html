<!DOCTYPE html>
<html lang="en">

<head>

    <!--[endif]-->

</head>

<body>
<!-- 	 -->
<div class="row">
    <div class="col-lg-12">
        <div class="panel panel-default">
            <div class="panel-heading">
                <ol class="breadcrumb">
                    <li><a href="#">系统设置</a></li>
                    <li class="active">公司与部门</li>
                </ol>
            </div>

            <div class="panel-body company-manage-panel">

                <div class="panel panel-info company-panel">
                    <div class="panel-heading">
                        公司
                    </div>
                    <div class="panel-body list-group">
                        <div class="form-group input-group">
                            <input type="text" class="form-control">
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="button"><i class="fa fa-search"></i>
                                </button>
                            </span>
                        </div>
                            <#if companyList ??>
                                <#list companyList as item>
                                        <a type="button" onclick="getDepartment(${item.id})" class="list-group-item" value="${item.id}"> ${item.name}</a>
                                </#list>
                            </#if>
                    </div>
                </div>
                <!--<div class="panel panel-default operation-panel">
                    <div class="panel-heading">
                        操作
                    </div>
                    <div class="panel-body ">-->
                        <div class="btn-group btn-group-vertical">
                            <button type="button" class="btn btn-info" data-toggle="modal" data-target="#addCompany">新增公司</button>
                            <button type="button" class="btn btn-warning">删除公司</button>
                        </div>

                  <!--  </div>
                </div>-->
                <div class="panel panel-success department-panel">
                    <div class="panel-heading">
                        部门
                    </div>
                    <div class="panel-body list-group">
                        <div class="form-group input-group">
                            <input type="text" class="form-control">
                            <span class="input-group-btn">
                                <button class="btn btn-default" type="button"><i class="fa fa-search"></i>
                                </button>
                            </span>
                        </div>
                    </div>
                </div>
                <div class="btn-group btn-group-vertical">
                    <button type="button" class="btn btn-info" data-toggle="modal" data-target="#addDepartment">新增部门</button>
                    <button type="button" class="btn btn-warning">删除部门</button>
                </div>
            </div>

            <!-- /.panel-body -->
        </div>
        <!-- /.panel -->
    </div>
    <!-- 新增公司弹框 -->
    <div class="modal fade" id="addCompany" tabindex="-1" role="dialog" aria-labelledby="addCompanyLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="addCompanyLabel">新增公司</h4>
                </div>
                <div class="modal-body modal-add-company">
                    <form role="form " class="col-lg-12 edit-form add-company-form">
                        <div class="col-lg-14 form-div">
                            <div class="form-group">
                                <label class="control-label" >公司名称</label>
                                <input type="text" class="form-control" id="companyName" name="companyName" placeholder="请输入公司名称">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary">保存</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>

    <!-- 新增组织弹框 -->
    <div class="modal fade" id="addDepartment" tabindex="-1" role="dialog" aria-labelledby="addDepartmentLabel" aria-hidden="true">
        <div class="modal-dialog">
            <div class="modal-content">
                <div class="modal-header">
                    <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
                    <h4 class="modal-title" id="addDepartmentLabel">新增部门</h4>
                </div>
                <div class="modal-body modal-add-department">
                    <form role="form " class="col-lg-12 edit-form add-department-form">
                        <div class="col-lg-14 form-div">
                            <div class="form-group">
                                <label class="control-label" >选择公司</label>
                                <select class="form-control" id="">
                                    <#if companyList ??>
                                        <#list companyList as company>
                                            <option value="${company.id}">${company.name}</option>
                                        </#list>
                                    </#if>
                                </select>
                            </div>

                            <div class="form-group">
                                <label class="control-label" >部门名称</label>
                                <input type="text" class="form-control" name="departmentName" placeholder="请输入部门名称">
                            </div>
                        </div>
                    </form>
                </div>
                <div class="modal-footer">
                    <button type="button" class="btn btn-primary">保存</button>
                    <button type="button" class="btn btn-default" data-dismiss="modal">关闭</button>
                </div>
            </div>
            <!-- /.modal-content -->
        </div>
        <!-- /.modal-dialog -->
    </div>
</div>
<!-- /.container-fluid -->
<script type="text/javascript">
    var companyids = "";
    var departmentids = "";
    $(".list-group-item").click(function(){
        if($(this).hasClass("active")){
            $(this).removeClass("active");
        } else {
            $(this).addClass("active");
        }
    });

    function getDepartment(companyId){
        $(".department-panel").find(".list-group").find("a").remove();
        $.post("${basePath}/department/getDepartment",{id:companyId},function(result){
            var departmentHtml = "";
            for(var i=0;i<result.length;i++){
                departmentHtml += '<a type="button" class="list-group-item" value="'+ result[i].id + '">'+result[i].name+'</a>';
            }
            $(".department-panel").find(".list-group").append(departmentHtml);
        });


    }
</script>

</body>

</html>
