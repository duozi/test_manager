<!DOCTYPE html>
<html lang="en">

<head>

    <meta charset="utf-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1">
    <meta name="description" content="">
    <meta name="author" content="">


</head>

<body>
<!-- 	 -->
<div class="panel-heading">
    <ol class="breadcrumb">
        <li><a href="#">接口自动化</a></li>
        <li><a href="#">测试用例管理</a></li>
        <li class="active">新增测试用例</li>
    </ol>
</div>
<div class="col-lg-14">
    <div class="panel panel-default">

        <form id="case-form" role="form" class="case-form">
            <div id="case-form-div">
                <div class="form-group ">
                    <label>用例名</label>
                    <input class="form-control col-lg-5">
                </div>
                <div class="form-group ">
                    <label>用例ID</label>
                    <input class="form-control col-lg-5">
                </div>
                <div class="form-group ">
                    <label>所属测试集</label>
                    <select class="form-control col-lg-5">
                        <option value="" disabled selected>选择测试集名称</option>
                        <option value="">2</option>
                        <option value="">3</option>
                        <option value="">4</option>
                        <option value="">5</option>
                    </select>
                </div>
                <div class="form-group ">
                    <label>所属系统</label>
                    <select class="form-control col-lg-5">
                        <option value="" disabled selected>选择系统名称</option>
                        <option value="">2</option>
                        <option value="">3</option>
                        <option value="">4</option>
                        <option value="">5</option>
                    </select>
                </div>
                <div class="form-group ">
                    <label>所属接口</label>
                    <select class="form-control col-lg-5">
                        <option value="" disabled selected>选择接口名称</option>
                        <option value="">2</option>
                        <option value="">3</option>
                        <option value="">4</option>
                        <option value="">5</option>
                    </select>
                </div>
                <div class="form-group">
                    <label class="control-label">数据准备/数据清除</label>
                    <div class="choose-sys case-choose">
                        <label class="checkbox-inline">
                            <input type="checkbox" value="prepare" name="operationType">数据准备
                        </label>
                        <label class="checkbox-inline">
                            <input type="checkbox" value="clear" name="operationType">数据清除
                        </label>
                    </div>
                </div>
                <div id="prepare-form-div" class="panel panel-default panel-collapse collapse operation-width">
                    <form id="prepare-form" class="edit-form  panel panel-default col-lg-10">
                        <!-- 数据准备 -->
                        <label class="control-label col-lg-4 title-label">数据准备</label>


                        <div class="panel panel-default operation">
                            <div class="panel-heading">
                                数据库操作
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>数据库名</th>
                                            <th>sql语句</th>
                                        </tr>
                                        </thead>
                                        <tbody>


                                        <tr>
                                            <td style=" border: none"><span id="addDbOperation"
                                                                            class="btn btn-info"><i
                                                    class="icon icon-plus-sign"></i>添加数据库操作</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- /.table-responsive -->
                            </div>
                            <!-- /.panel-body -->
                        </div>
                        <div class="panel panel-default operation">
                            <div class="panel-heading">
                                redis操作
                            </div>
                            <div class="panel-body">
                                <div class="table-responsive">
                                    <table class="table">
                                        <thead>
                                        <tr>
                                            <th>redis名</th>
                                            <th>redis操作类型</th>
                                        </tr>
                                        </thead>
                                        <tbody>


                                        <tr>
                                            <td style=" border: none"><span id="addRedisOperation"
                                                                            class="btn btn-info"><i
                                                    class="icon icon-plus-sign"></i>添加redis操作</span></td>
                                        </tr>
                                        </tbody>
                                    </table>
                                </div>
                                <!-- /.table-responsive -->
                            </div>
                            <!-- /.panel-body -->
                        </div>
                    </form>
                </div>


                <!--<div id="prepare">-->
                <!--<div class="form-group ">-->
                <!--<label>数据准备</label>-->
                <!--<div class="dropdown  col-lg-5 plus">-->
                <!--<button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu1"-->
                <!--data-toggle="dropdown">-->
                <!--<span class="glyphicon glyphicon-plus"></span>-->
                <!--</button>-->
                <!--<ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">-->
                <!--<li role="presentation"><a role="menuitem" tabindex="1" name="operationType">数据库操作</a>-->
                <!--</li>-->
                <!--<li role="presentation"><a role="menuitem" tabindex="2"-->
                <!--name="operationType">redis操作</a></li>-->
                <!--</ul>-->
                <!--</div>-->
                <!--</div>-->
                <!--</div>-->
                <div class="form-group param-text">
                    <label>请求参数</label>
                    <textarea class=" form-control  text-control "></textarea>
                </div>
                <div id="clear">
                    <div class="form-group ">
                        <label>数据清除</label>
                        <div class="dropdown  col-lg-5 plus">
                            <button class="btn btn-default dropdown-toggle" type="button" id="dropdownMenu2"
                                    data-toggle="dropdown">
                                <span class="glyphicon glyphicon-plus"></span>
                            </button>
                            <ul class="dropdown-menu" role="menu" aria-labelledby="dropdownMenu1">
                                <li role="presentation"><a role="menuitem" tabindex="3" name="operationType">数据库操作</a>
                                </li>
                                <li role="presentation"><a role="menuitem" tabindex="4"
                                                           name="operationType">redis操作</a></li>
                            </ul>
                        </div>
                    </div>
                </div>

            </div>
        </form>
    </div>
</div>


<script type="text/javascript">
    var dbId = 0;
    var redisId = 0;

    $("input[name='operationType']").click(
            function () {
                var value = $(this).val();
                if (value == "prepare" && $(this).is(':checked')) {
                    $("#prepare-form-div").addClass("in");
                } else if (value == "prepare" && !$(this).is(':checked')) {
                    $("#prepare-form-div").removeClass("in");
                }
                if (value == "clear" && $(this).is(':checked')) {
                    $("#http-form-div").addClass("in");
                } else if (value == "http" && !$(this).is(':checked')) {
                    $("#http-form-div").removeClass("in");
                }
            }
    );
    $("#addDbOperation").click(function () {
        var html = '<tr>';
        html += '<div class="row">';
        html += '<form id="http-request-form" class="">';
        html += '<div>';
        html += '<div class="col-xs-2">';
        html += '<td>';
        html += '<select class="form-control" id="dbName" name="dbName">';
        html += '<#if contentTypeList ??>';
        html += '<#list contentTypeList as item>';
        html += '<option values="${item.getId()}">${item.getName()} </option>';
        html += '</#list>';
        html += '</#if>';
        html += '</select>';
        html += '</td>';
        html += '</div>';
        html += '<div class="col-xs-9">';
        html += '<td><input type="text" class="form-control" placeholder="sql语句"></td>';
        html += '</div>';

        html += '<div class="col-xs-2">';
        html += '<td>';
        html += '<button type="submit" class="btn btn-info">保存</button>';
        html += '</td>';

        html += '</div>';
        html += '<div class="col-xs-2">';
        html += '<td>';
        html += '<button type="button" name="delete" class="btn btn-info">删除</button>';
        html += '</td>';
        html += '</div>';
        html += '</div>';
        html += '</form>';
        html += '</div>';
        html += '</tr>';
        $(this).parent().parent().before(html);


        $("button[name='delete']").click(function () {
            $(this).parent().parent().remove();
        })
    })

    $("a[name='aoperationType']").click(function () {
        dbId += 1;
        redisId += 1;
        var appendDb = '<div class="form-group">';
        appendDb += '<div id="db-operation-div-' + dbId + '" class="panel panel-default db-operation-div">';
        appendDb += '<label class="control-label col-lg-6 title-label case-label">数据库操作</label>';
        appendDb += '<div class="case-div">';
        appendDb += '<div class="form-group">';
        appendDb += '<label>数据库名</label>';
        appendDb += '<select class="form-control col-lg-5 case-select" id="dbName" name="dbName">';
        appendDb += '<option values="true">a</option>';
        appendDb += '<option values="false">b</option>';
        appendDb += '<option values="false">c</option>';
        appendDb += '</select>';
        appendDb += '</div>';
        appendDb += '<div class="form-group">';
        appendDb += '<label>sql</label>';
        appendDb += '<textarea class="form-control  text-control"></textarea>';
        appendDb += '</div>';
        appendDb += '</div>';
        appendDb += '</div>';
        appendDb += '<button class="btn btn-default dropdown-toggle minus" type="button" name="minus" data-toggle = "dropdown" >';
        appendDb += '<span class="glyphicon glyphicon-minus"></span>';
        appendDb += '</button>';
        appendDb += '</div>';

        var appendRedis = '<div class="form-group">';
        appendRedis += '<div id="redis-operation-div-' + redisId + '" class="panel panel-default redis-operation-div">';

        appendRedis += '<label class="control-label col-lg-6 title-label case-label">redis操作</label>';
        appendRedis += '<div class="case-div">';
        appendRedis += '<div class="form-group">';
        appendRedis += '<label class="control-label">redis名</label>';
        appendRedis += '<select class="form-control case-select" id="redisOperationType" name="redisOperationType">';
        appendRedis += '<option values="true" tabindex="1">set</option>';
        appendRedis += '<option values="false" tabindex="2">del</option>';
        appendRedis += '<option values="false" tabindex="3">expire</option>';
        appendRedis += '</select>';
        appendRedis += '</div>';
        appendRedis += '<div id="key-' + redisId + '" class="form-group ">';
        appendRedis += '<label>key</label>';
        appendRedis += '<input class="form-control">';
        appendRedis += '</div>';
        appendRedis += '<div id="value-' + redisId + '" class="form-group ">';
        appendRedis += '<label>value</label>';
        appendRedis += '<input class="form-control">';
        appendRedis += '</div>';
        appendRedis += '<div id="time-' + redisId + '" class="form-group ">';
        appendRedis += '<label>time</label>';
        appendRedis += '<input class="form-control">';
        appendRedis += '</div>';
        appendRedis += '</div>';
        appendRedis += '</div>';
        appendRedis += '<button  class="btn btn-default dropdown-toggle minus" type="button" name="minus" data-toggle="dropdown">';
        appendRedis += '<span class="glyphicon glyphicon-minus"></span>';
        appendRedis += '</button>';
        appendRedis += '</div>';

        var value = $(this).attr("tabindex");
        if (value == 1) {
            $("#prepare").append(appendDb);

        } else if (value == 2) {
            $("#prepare").append(appendRedis);

        } else if (value == 3) {
            $("#clear").append(appendDb);
        } else if (value == 4) {
            $("#clear").append(appendRedis);
        }


        $("button[name='minus']").click(function () {
            $(this).parent().remove();
        });

        $("select[name='redisOperationType']").change(function () {
            var value = $(this).val();
            var keyId = 'key-' + redisId;
            var valueId = 'value-' + redisId;
            var timeId = 'time-' + redisId;
            var keyClass = $("#" + keyId).hasClass("case-not-show");
            var valueClass = $("#" + valueId).hasClass("case-not-show");
            var timeClass = $("#" + timeId).hasClass("case-not-show");
            if (value == 'del') {
                if (keyClass) {
                    $("#" + keyId).removeClass("case-not-show");
                }

                if (!valueClass) {
                    $("#" + valueId).addClass("case-not-show");
                }

                if (!timeClass) {
                    $("#" + timeId).addClass("case-not-show");
                }

            } else if (value == 'set') {
                if (keyClass) {
                    $("#" + keyId).removeClass("case-not-show");
                }
                if (valueClass) {
                    $("#" + valueId).removeClass("case-not-show");
                }
                if (timeClass) {
                    $("#" + timeId).removeClass("case-not-show");
                }
            } else if (value == 'expire') {
                if (keyClass) {
                    $("#" + keyId).removeClass("case-not-show");
                }
                if (!valueClass) {
                    $("#" + valueId).addClass("case-not-show");
                }
                if (timeClass) {
                    $("#" + timeId).removeClass("case-not-show");
                }
            }

        });
    });


</script>
</body>

</html>